{% extends 'gym/member/member_base.html' %}
{% load static %}

{% block title %}Member Dashboard{% endblock %}

{% block style %}
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script src="https://kit.fontawesome.com/a2e0f1f1f1.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
    body {
        background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .glass-box {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(14px);
        -webkit-backdrop-filter: blur(14px);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        color: #fff;
    }

    .profile-img {
        border: 4px solid #34d399;
        border-radius: 20px;
        box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.5);
    }

    .glow-text {
        text-shadow: 0 0 10px #34d399, 0 0 20px #34d399;
    }

    .btn-toggle {
        padding: 10px 20px;
        border-radius: 25px;
        background-color: #34d399;
        color: white;
        font-size: 14px;
    }

    .btn-toggle:hover {
        background-color: #28a745;
        cursor: pointer;
    }

    .notification {
        background-color: #28a745;
        color: white;
        padding: 10px;
        border-radius: 5px;
        margin-bottom: 15px;
    }

    {% comment %} @media (prefers-color-scheme: dark) {
        body {
            background: #1e293b;
        }
        .glass-box {
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
        }
    } {% endcomment %}
</style>

{% endblock %}

{% block content %}
<audio autoplay >
    <source src="{% static 'gym/video_audio/userhome.mp3' %}" type="audio/mpeg">
</audio>



{% if messages %}
    {% for m in messages %}
    <div class="notification">
        {{ m }}
    </div>
    {% endfor %}
{% endif %}

<div class="max-w-6xl mx-auto mt-10 p-5">
    <div class="flex flex-col md:flex-row items-center justify-between gap-10 glass-box transition-all duration-700">
        
          <!-- Toggle Dark Mode -->
                   <div class="fixed top-4 right-4">
                       <button class="btn-toggle" onclick="toggleDarkMode()">Toggle Dark Mode</button>
                   </div>
                   
        <!-- Profile Image -->
        <div class="w-full md:w-1/3">
            <img src="/media/{{ member_key.profile_picture }}" class="w-full h-auto profile-img" alt="Profile Picture">
        </div>

        <!-- Member Info -->
        <div class="w-full md:w-2/3 text-left">
            <h2 class="text-3xl font-bold glow-text mb-4">üë§ {{ member_key.name }}</h2>
            <p class="mb-2"><i class="fas fa-envelope text-green-300 mr-2"></i> <strong>Email:</strong> {{ member_key.email }}</p>
            <p class="mb-2"><i class="fas fa-phone text-green-300 mr-2"></i> <strong>Phone:</strong> {{ member_key.phone }}</p>
            <p class="mb-2"><i class="fas fa-map-marker-alt text-green-300 mr-2"></i> <strong>Address:</strong> {{ member_key.address }}</p>
            <p class="mb-2"><i class="fas fa-city text-green-300 mr-2"></i> <strong>City:</strong> {{ member_key.city }}, {{ member_key.state }}</p>
            <p class="mb-2"><i class="fas fa-calendar-check text-green-300 mr-2"></i> <strong>Joined:</strong> {{ member_key.date_joined|date:"M d, Y" }}</p>
        </div>
    </div>

    <!-- Gym Info -->
    <div class="glass-box mt-8 text-center">
        {% if member_key.gym %}
            <h3 class="text-2xl font-semibold glow-text mb-2">üèãÔ∏è‚Äç‚ôÇÔ∏è Gym Membership</h3>
            <p class="text-lg">You are currently a member of <span class="font-bold text-green-300">{{ member_key.gym }}</span>.</p>
            <a href="{% url 'gym_locator_with_name' member_key.gym.gym_name %}" class="inline-block mt-4 px-5 py-2 bg-green-500 hover:bg-green-600 text-white rounded transition-all duration-300">
                View Gym Details
            </a>
        {% else %}
            <h3 class="text-2xl font-semibold glow-text mb-2">No Gym Found üòî</h3>
            <p class="text-lg">You're not enrolled in any gym currently.</p>
            <a href="{% url 'gym_locator' %}" class="inline-block mt-4 px-5 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded transition-all duration-300">
                Find a Gym Now
            </a>
        {% endif %}
    </div>

    <!-- Progress Chart -->
    <div class="glass-box mt-8 p-8">
        <h3 class="text-2xl font-semibold glow-text text-center mb-6">üìä Your Progress</h3>
        <canvas id="progressChart"></canvas>
    </div>
</div>

<script>
    // Dark Mode Toggle
    function toggleDarkMode() {
        const currentTheme = localStorage.getItem('theme');
        if (currentTheme === 'dark') {
            localStorage.setItem('theme', 'light');
            document.body.classList.remove('dark');
        } else {
            localStorage.setItem('theme', 'dark');
            document.body.classList.add('dark');
        }
    }

    // Check and apply theme on page load
    if (localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark');
    }

    // Chart.js Progress Chart
    var ctx = document.getElementById('progressChart').getContext('2d');
    var progressChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4' ],
            datasets: [{
                label: 'Your Progress',
                data: [10, 20, 30, 50],  // Sample data, should be replaced with actual member progress data
                borderColor: '#34d399',
                backgroundColor: 'rgba(52, 211, 153, 0.2)',
                borderWidth: 3,
                fill: true,
            }]
        },
        options: {
            responsive: true,
            scales: {
                x: {
                    ticks: {
                        color: '#fff'
                    }
                },
                y: {
                    ticks: {
                        color: '#fff'
                    }
                }
            }
        }
    });
</script>
{% endblock %}
